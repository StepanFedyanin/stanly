!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){n(1),e.exports=n(5)},function(e,t,n){var a=n(2);"string"==typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(3)(a,r);a.locals&&(e.exports=a.locals)},function(e,t,n){},function(e,t,n){var a,r,o={},i=(a=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=a.apply(this,arguments)),r}),s=function(e,t){return t?t.querySelector(e):document.querySelector(e)},l=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var a=s.call(this,e,n);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}t[e]=a}return t[e]}}(),c=null,d=0,u=[],p=n(4);function f(e,t){for(var n=0;n<e.length;n++){var a=e[n],r=o[a.id];if(r){r.refs++;for(var i=0;i<r.parts.length;i++)r.parts[i](a.parts[i]);for(;i<a.parts.length;i++)r.parts.push(_(a.parts[i],t))}else{var s=[];for(i=0;i<a.parts.length;i++)s.push(_(a.parts[i],t));o[a.id]={id:a.id,refs:1,parts:s}}}}function m(e,t){for(var n=[],a={},r=0;r<e.length;r++){var o=e[r],i=t.base?o[0]+t.base:o[0],s={css:o[1],media:o[2],sourceMap:o[3]};a[i]?a[i].parts.push(s):n.push(a[i]={id:i,parts:[s]})}return n}function h(e,t){var n=l(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var a=u[u.length-1];if("top"===e.insertAt)a?a.nextSibling?n.insertBefore(t,a.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),u.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=l(e.insertAt.before,n);n.insertBefore(t,r)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var a=function(){0;return n.nc}();a&&(e.attrs.nonce=a)}return $(t,e.attrs),h(e,t),t}function $(e,t){Object.keys(t).forEach((function(n){e.setAttribute(n,t[n])}))}function _(e,t){var n,a,r,o;if(t.transform&&e.css){if(!(o="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=o}if(t.singleton){var i=d++;n=c||(c=v(t)),a=j.bind(null,n,i,!1),r=j.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",$(t,e.attrs),h(e,t),t}(t),a=T.bind(null,n,t),r=function(){g(n),n.href&&URL.revokeObjectURL(n.href)}):(n=v(t),a=w.bind(null,n),r=function(){g(n)});return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=m(e,t);return f(n,t),function(e){for(var a=[],r=0;r<n.length;r++){var i=n[r];(s=o[i.id]).refs--,a.push(s)}e&&f(m(e,t),t);for(r=0;r<a.length;r++){var s;if(0===(s=a[r]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete o[s.id]}}}};var b,y=(b=[],function(e,t){return b[e]=t,b.filter(Boolean).join("\n")});function j(e,t,n,a){var r=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=y(t,r);else{var o=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(o,i[t]):e.appendChild(o)}}function w(e,t){var n=t.css,a=t.media;if(a&&e.setAttribute("media",a),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function T(e,t,n){var a=n.css,r=n.sourceMap,o=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||o)&&(a=p(a)),r&&(a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var i=new Blob([a],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(i),s&&URL.revokeObjectURL(s)}},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,a=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var r,o=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?e:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?n+o:a+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(e,t,n){"use strict";n.r(t);var a=2;function r(){var e="Unknown";return-1!=navigator.appVersion.indexOf("Win")?e="Windows":-1!=navigator.appVersion.indexOf("Mac")?e="MacOS":-1!=navigator.appVersion.indexOf("X11")?e="UNIX":-1!=navigator.appVersion.indexOf("Linux")&&(e="Linux"),e}function o(e){var t="\n";return"Windows"==e?t="\r\n":("MacOS"==e||"UNIX"==e||"Linux"==e)&&(t="\n"),t}function i(e,t){let n=$(t),r=`<div class="step-page__scale">\n                    <input type="text" class="step-page__scale-input input" name="scale-${a}" placeholder="Введите название" value="${e=e||""}">\n                    <button onclick="removeScale(this)" type="button" class="step-page__scale-remove">Удалить шкалу</button>\n                </div>`;n.append(r),a++}function s(e,t){let n=function(e){var t=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),a=0;a<n.length;a++){var r=$.trim(n[a]);if(r.substring(0,e.length+1)==e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}return t}("csrftoken");$.ajax({type:"GET",headers:{"X-CSRFToken":n},url:e,dataType:"json",success:function(e){if(void 0===e.html)throw Error("no success data");t(JSON.parse(e.html).html)}})}function l(e){let t,n,a,r=$(this);if(!e||void 0===e.data)return void alert("Ошибка! Попробуйте позже!");t=e.data.calc_name,n=e.data.IncCurrLabel,a=e.data.price_type;let o=!1,i=r.parent();if(!o){let e=r.parent().find('[name="csrfmiddlewaretoken"]').val(),s={calc_name:t,IncCurrLabel:n,price_type:a};i.prop("disabled","disabled"),o=!0,$.ajax({url:"/all/ajax/get_payment_methods/",data:s,method:"POST",dataType:"html",headers:{"X-CSRFToken":e},success:function(e){$.fancybox.open({src:e,type:"html",opts:{buttons:[],padding:0,smallBtn:!1}}),i.prop("disabled",""),o=!1},error:function(e){alert("Ошибка! Попробуйте позже!"),i.prop("disabled",""),o=!1}})}}function c(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",(function(e){let t=this.getAttribute("href");return""!==t&&"#"!==t&&document.querySelector(this.getAttribute("href")).scrollIntoView({behavior:"smooth"}),!0}))})}function d(e){$.fancybox.destroy(),$.fancybox.open({src:e,type:"html",opts:{buttons:[],padding:0,smallBtn:!1}})}function u(e){if("undefined"!=typeof ym){let t={};e&&e.find('input[name="shpfull_price"]').length&&(t.order_price=e.find('input[name="shpfull_price"]').val()),ym(YM_ID,"reachGoal","pay",t)}}function p(){"undefined"!=typeof ga&&ga("send","event","robokassa_form","pay")}function f(){let e=$(".js-show-password");e.length&&e.click((function(){let e=$(this).prev();return"password"==e.attr("type")?e.attr("type","text"):e.attr("type","password"),!1}))}function m(){let e=document.getElementById("preloader");e?setTimeout(()=>{e.style.display="block"},400):console.log("No preloader")}function h(){let e=$(".js-login-form"),t=$(".js-popup"),n=$(".js-password-reset"),a=e.find(".js-fieldset"),r=e.find(".js-error"),o=a.find("input"),i=e.attr("action"),l={},c=!1,u=e.find('[name="csrfmiddlewaretoken"]').val(),p=e.find('[name="next"]'),m="",h=t.find(".js-signup");p.length&&(m=p.val()),e.length&&e.submit((function(e){return c||($.each(o,(function(){let e=$(this);l[e.attr("name")]=e.val()})),r.html(""),a.prop("disabled","disabled"),c=!0,$.ajax({url:i,data:l,method:"POST",dataType:"json",headers:{"X-CSRFToken":u},success:function(e){if(a.prop("disabled",""),$.isEmptyObject(e.errors))window.location.href=m;else{let t=e.errors;for(let e in t)r.append(`<p class="error">${t[e]}</p>`);c=!1}},error:function(e){alert("Ошибка! Попробуйте позже!"),a.prop("disabled",""),c=!1}})),!1})),n.length&&n.click((function(e){let t=$(this).attr("href");return $.ajax({url:t,method:"GET",dataType:"json",headers:{"X-CSRFToken":u},success:function(e){d(JSON.parse(e.html).html),function(){let e=$(".js-reset-form"),t=($(".js-popup"),e.find(".js-fieldset")),n=e.find(".js-error"),a=t.find("input"),r=e.attr("action"),o={},i=!1,s=e.find('[name="csrfmiddlewaretoken"]').val();e.length&&e.submit((function(l){return i||($.each(a,(function(){let e=$(this);o[e.attr("name")]=e.val()})),n.html(""),t.prop("disabled","disabled"),i=!0,$.ajax({url:r,data:o,method:"POST",dataType:"json",headers:{"X-CSRFToken":s},success:function(a){if(t.prop("disabled",""),$.isEmptyObject(a.errors)){let t="/all/accounts/reset_password_done_ajax/";$.ajax({url:t,method:"GET",dataType:"html",headers:{},success:function(t){e.parent().parent().html(t)},error:function(e){alert("Ошибка! Попробуйте позже!")}}),$.fancybox}else{let e=a.errors;for(let t in e)n.append(`<p class="error">${e[t]}</p>`)}i=!1,t.prop("disabled","")},error:function(e){alert("Ошибка! Попробуйте позже!"),t.prop("disabled",""),i=!1}})),!1})),f()}()},error:function(e){alert("Ошибка! Попробуйте позже!")}}),!1})),h.length&&h.click((function(e){s("/all/accounts/signup_ajax/",(function(e){d(e),g()}))})),f()}function g(){let e=$(".js-signup-form"),t=$(".js-popup"),n=e.find(".js-fieldset"),a=e.find(".js-error"),r=n.find("input"),o=e.attr("action"),i={},l=!1,c=e.find('[name="csrfmiddlewaretoken"]').val(),u=e.find('[name="next"]'),p="",m=t.find(".js-login");u.length&&(p=u.val()),e.length&&e.submit((function(t){if(!l){let t;$.each(r,(function(){let e=$(this);i[e.attr("name")]=e.val(),"email"==e.attr("name")&&(t=e.val())})),a.html(""),n.prop("disabled","disabled"),l=!0,$.ajax({url:o,data:i,method:"POST",dataType:"json",headers:{"X-CSRFToken":c},success:function(r){if(n.prop("disabled",""),$.isEmptyObject(r.errors)){let n="/all/accounts/verification_sent_ajax/";$.ajax({url:n,data:{email:t},method:"GET",dataType:"html",headers:{},success:function(t){e.parent().parent().html(t)},error:function(e){alert("Ошибка! Попробуйте позже!")}})}else{let e=r.errors;for(let t in e)a.append(`<p class="error">${e[t]}</p>`);l=!1}},error:function(e){alert("Ошибка! Попробуйте позже!"),n.prop("disabled",""),l=!1}})}return!1})),m.length&&m.click((function(e){s("/all/accounts/login_ajax/",(function(e){d(e),h()}))})),f()}function v(){if("undefined"!=typeof ym){let e={};$(document).on("submit",".js-ym-registration",(function(t){ym(YM_ID,"reachGoal","registration",e)})),$(document).on("submit",".js-ym-autorization",(function(t){ym(YM_ID,"reachGoal","autorization",e)})),$(document).on("submit",".js-ym-pay",(function(t){$('input[name="OutSum"]').length&&(e.order_price=$('input[name="OutSum"]').val()),ym(YM_ID,"reachGoal","pay",e)}))}"undefined"!=typeof ga&&($(document).on("submit",".js-ym-registration",(function(e){ga("send","event","account","registration")})),$(document).on("submit",".js-ym-autorization",(function(e){ga("send","event","account","autorization")})),$(document).on("submit",".js-ym-pay",(function(e){ga("send","event","robokassa_form","pay")})))}window.STEP=$("body").data("step"),window.CALC_NAME=$("body").data("calc-name"),document.addEventListener("DOMContentLoaded",()=>{window&&window.innerWidth,function(){let e=$(".js-signup"),t=$(".js-login"),n=$(".js-menu-parent .calc-menu__link"),a=($(".js-robokassa-form").find("form"),$(".js-get-payment-methods")),r=$(".js-achievement-close"),o=$(".js-popup-with-content");e.length&&e.click((function(e){s("/all/accounts/signup_ajax/",(function(e){d(e),g()}))})),t.length&&t.click((function(e){s("/all/accounts/login_ajax/",(function(e){d(e),h()}))})),n.length&&n.click((function(e){let t=$(this).parent();t.children("ul").slideToggle(),t.toggleClass("is-active")})),r.length&&r.click((function(e){let t=$(this);$.ajax({url:"/all/ajax/achievement_close/",method:"POST",dataType:"html",headers:{},success:function(e){t.parent().slideToggle()},error:function(e){alert("Ошибка! Попробуйте позже!")}})})),$.each(a,(function(e,t){$(t).click({calc_name:$(t).data("calc-name"),price_type:$(t).parent().find("[name=price_type]").val()},l)})),o.length&&o.click((function(e){let t=$(this),n=t.data("url"),a={calc_name:t.data("calc-name")};$.ajax({url:n,data:a,method:"POST",dataType:"html",success:function(e){$.fancybox.open({src:e,type:"html",opts:{buttons:["close"],padding:0,smallBtn:!1,btnTpl:{close:'<button data-fancybox-close class="popup__close""></button>"'}}})},error:function(e){alert("Ошибка! Попробуйте позже!")}})}))}(),"index"==STEP||("scales"==STEP?function(){let e=$(".js-add-new-input"),t=$(".js-scale-group"),n=$(".js-form-scales"),a=$(".js-form-upload"),s=$('[name="group_quantity"]'),l=($(".js-quantity"),$(".js-quantity-error")),c=[],d=$('[name="next_step"]').val(),u=!1,p=$(".js-clear-storage");void 0===sessionStorage[CALC_NAME]&&(sessionStorage[CALC_NAME]="{}"),"{}"==sessionStorage[CALC_NAME]&&p.hide();var f=JSON.parse(sessionStorage[CALC_NAME]);if(f.scales&&(c=f.scales),f.group_quantity&&s.val(f.group_quantity),c.length){t.html("");for(let e in c)i(c[e],".js-scale-group")}e.click((function(){i(!1,".js-scale-group")})),n.length&&n.submit((function(e){let t=$(this),n=t.find('[name="csrfmiddlewaretoken"]').val(),a=t.find(".js-fieldset"),r=t.attr("action"),o={},i=[];if(!u){let e=$(".js-scale-group").find("input"),t=$(".js-scale-error");u=!0,t.removeClass("error"),l.length&&l.removeClass("error"),a.prop("disabled","disabled"),$.each(e,(function(e){let t=$(this);i.push(t.val()),o[e]=t.val()})),o.calc_name=CALC_NAME,$('[name="group_quantity"]').length&&(o.group_quantity=parseInt($('[name="group_quantity"]').val()),f.group_quantity=o.group_quantity),$.ajax({url:r,data:o,method:"POST",dataType:"html",headers:{"X-CSRFToken":n},success:function(e){"OK"==e&&(f.scales=i,sessionStorage[CALC_NAME]=JSON.stringify(f),window.location.href=d)},error:function(e){"ERROR"==e.responseText?t.addClass("error"):"QUANTITY"==e.responseText?l.addClass("error"):alert("Ошибка! Попробуйте позже!"),u=!1,a.prop("disabled","")}})}return!1})),t.on("paste","input",(function(e){let n=$(this);return $.each(e.originalEvent.clipboardData.items,(function(e,a){"text/plain"===a.type&&a.getAsString((function(e){let a=o(r()),s=n.closest(".js-scale-input").index(),l=0,c=(e=e.trim(a)).split(new RegExp("["+a+"|\t]"));$.each(c,(function(e,n){if(""==n)return l++,!0;n=n.trim(" ");let a=s+e-l,r=t.find(`.js-scale-input:eq(${a}) input`);r.length?r.val(n):i(n,".js-scale-group")}))}))})),!1})),a.length&&a.submit((function(e){let t=$(this);if(!u){let e=t.find('[name="csrfmiddlewaretoken"]').val(),n=t.find(".js-scale-error"),a=t.find(".js-fieldset"),r=t.attr("action"),o=new FormData(t[0]);u=!0,n.removeClass("error"),a.prop("disabled","disabled"),$.ajax({url:r,data:o,cache:!1,contentType:!1,processData:!1,enctype:"multipart/form-data",method:"POST",dataType:"json",headers:{"X-CSRFToken":e},success:function(e){f.scales=e,sessionStorage[CALC_NAME]=JSON.stringify(f),window.location.href=""},error:function(e){u=!1,alert("Ошибка! Попробуйте позже!"),a.prop("disabled","")}})}return!1})),p&&p.click((function(){!function(){let e=$('[name="csrfmiddlewaretoken"]').val();delete sessionStorage[CALC_NAME],$.ajax({url:"/all/ajax/session_clear/",method:"POST",headers:{"X-CSRFToken":e},success:function(e){window.location.href=""}})}()}))}():"set-groups"==STEP?function(){let e=$('[name="group_number"]').val(),t=$('[name="step"]').val(),n=$(".js-form-group"),a=$(".js-group-data"),i=$("#group_name"),s=$("#group_count"),l=$(".js-hide-on-click"),c=!1,d=!1,u=$('[name="csrfmiddlewaretoken"]').val();var p=JSON.parse(sessionStorage[CALC_NAME]);function f(e){var t=$(this);return $.each(e.originalEvent.clipboardData.items,(function(e,n){"text/plain"===n.type&&n.getAsString((function(e){var n=o(r()),a=(new RegExp("[(s*)]"),0),i=t.closest("td").index()-1,s=t.closest("tr").index();e=e.trim(n),$.each(e.split(new RegExp("["+n+"]")),(function(e,n){if(""==n)return a++,!0;$.each(n.split("\t"),(function(n,r){r=r.trim(" ");var o=s+e,l=i+n,c=t.closest("tbody").find("tr:eq("+(o-a)+") td:eq("+l+") input");c.length&&c.val(r)}))}))}))})),!1}p["group_name_"+e]&&p["group_count_"+e]&&p["group_data_"+e]&&(c=!0),p["group_name_"+e]&&i.val(p["group_name_"+e]),p["group_count_"+e]&&s.val(p["group_count_"+e]),n.length&&n.submit((function(n){let r=$(this),o=!0;if($(".error").removeClass("error"),i.val()||(i.addClass("error"),i.prev().addClass("error"),o=!1),s.val()&&parseInt(s.val())||(s.addClass("error"),s.prev().addClass("error"),o=!1),o&&!d){let n=r.attr("action"),o={};d=!0,p["group_name_"+e]=o.group_name=i.val(),p["group_count_"+e]=o.group_count=parseInt(s.val()),o.step=t,o.group_number=e,o.calc_name=CALC_NAME,sessionStorage[CALC_NAME]=JSON.stringify(p),$.ajax({url:n,data:o,method:"POST",dataType:"html",headers:{"X-CSRFToken":u},success:function(e){a.html(e),l.hide(),a.on("paste","input",f),d=!1,function(){let e=$(".js-form-values"),t=e.find('[name="group_number"]').val(),n=e.find('[name="group_name"]').val(),a=e.find('[name="group_count"]').val(),r=e.find("tbody input"),o=$('[name="next_step"]').val(),i=!1,s=$(".js-form-upload");var l=JSON.parse(sessionStorage[CALC_NAME]);if(void 0!==l["group_data_"+t]){let e=l["group_data_"+t];$.each(r,(function(){let t=$(this);void 0!==e[t.data("scale")]&&void 0!==e[t.data("scale")][t.data("person")]&&t.val(e[t.data("scale")][t.data("person")])}))}e.length&&e.submit((function(s){if(function(e){let t=$("."+e),n=t.find(".js-zeroed"),a=!0,r=t.find("input"),o=$("#confirm");return n.click((function(){$.each(r,(function(){let e=$(this);""==e.val()&&e.val("0")})),t.trigger("submit")})),$.each(r,(function(){if(""==$(this).val())return $.fancybox.open({src:o,type:"html",opts:{buttons:[],padding:0,smallBtn:!1,helpers:{overlay:{css:{"background-color":"rgba(0,0,0,.3)"}}}}}),a=!1,!1})),a}("js-form-values")&&!i){let s=$(this),c=e.find('[name="csrfmiddlewaretoken"]').val(),d={},u=s.find(".js-fieldset"),p=s.attr("action");$.each(r,(function(){let e=$(this);d[e.data("scale")]||(d[e.data("scale")]={});let t=parseFloat(e.val().replace(/,/,"."));d[e.data("scale")][e.data("person")]=t,isNaN(d[e.data("scale")][e.data("person")])&&(d[e.data("scale")][e.data("person")]=0)})),i=!0,u.prop("disabled","disabled"),$.ajax({url:p,data:{group_data:JSON.stringify(d),group_count:a,group_name:n,group_number:t,calc_name:CALC_NAME},method:"POST",dataType:"html",headers:{"X-CSRFToken":c},success:function(e){"OK"==e?(l["group_data_"+t]=d,sessionStorage[CALC_NAME]=JSON.stringify(l),window.preloader(),window.location.href=o):(i=!1,u.prop("disabled",""))},error:function(e){let t=JSON.parse(e.responseText);t.DATA_ERROR?alert(`Стандартное отклонение шкалы ${t.DATA_ERROR} равно 0 - вычисление не возможно. Для того, чтобы была возможность произвести вычисления нужно, чтобы значения шкалы ${t.DATA_ERROR} отличались друг от друга`):alert("Ошибка! Попробуйте позже!"),i=!1,u.prop("disabled","")}})}return!1})),s.length&&s.submit((function(e){let n=$(this);if(!i){let e=n.find('[name="csrfmiddlewaretoken"]').val(),a=n.find(".js-scale-error"),r=n.find(".js-fieldset"),o=n.attr("action"),s=new FormData(n[0]);a.removeClass("error"),$.ajax({url:o,data:s,cache:!1,contentType:!1,processData:!1,enctype:"multipart/form-data",method:"POST",dataType:"json",headers:{"X-CSRFToken":e},success:function(e){l["group_data_"+t]=e,sessionStorage[CALC_NAME]=JSON.stringify(l),window.location.href=""},error:function(e){i=!1,alert("Ошибка! Попробуйте позже!"),r.prop("disabled","")}})}return!1}))}(),function(){let e=$(".js-table"),t=e.parent(),n=$(".js-table-copy");$(".js-thead-copy").innerHeight(e.find(".table__thead-th").innerHeight()),$(".js-tcell-copy").innerHeight(e.find(".table__tbody-th").innerHeight()-2),t.scroll((function(e){t.scrollLeft()>10?n.addClass("active"):n.removeClass("active")}))}()},error:function(t){if("count"==t.responseText){let t=1==e?p.group_name_2:p.group_name_1,n=1==e?p.group_count_2:p.group_count_1;alert("В группе "+t+" "+n+" человек, поэтому в текущей группе должно быть тоже "+n+" человек. Группы должны быть равны по количеству участников.")}else"NO_SCALES"==t.responseText&&alert("Нет шкал для заполнения! Сначала заполните шкалы на предыдущем шаге");d=!1}})}else console.log("Invalid info.");n.preventDefault(),n.stopPropagation()})),c&&n.trigger("submit")}():"prepare"==STEP?function(){var e=JSON.parse(sessionStorage[CALC_NAME]);let t=$(".js-form"),n=$('[name="next_step"]').val(),a=$('[name="calc_name"]').val(),r=$('[name="group_count"]').val(),o=$(".js-fieldset"),i=t.attr("action"),s=$('[name="csrfmiddlewaretoken"]').val(),l=$('[name="json"]'),c=!1,d={};for(let t=1;t<=r;t++)d["group_name_"+t]=e["group_name_"+t],d["group_count_"+t]=e["group_count_"+t],d["group_data_"+t]=e["group_data_"+t];d.group_quantity=e.group_quantity,function(){let t={},n=$(".js-table"),o=$(".js-group-change-link");for(let n=1;n<=r;n++){try{t["group_data_"+n]=e["group_data_"+n]}catch(e){console.error(e)}Object.keys(t["group_data_"+n]).length?i(e["group_count_"+n],t["group_data_"+n],e["group_name_"+n],n):console.error("no data")}function i(e,t,a,r){let o="";for(let n=0;n<e;n++){o+=`<tr class="table__tbody-tr table__group-row--${r}">`,o+=`<th class="table__tbody-th" scope="row">Группа "${a}" / Испытуемый ${n+1}</th>`;for(let e in t)o+=`<td class="table__tbody-td">${t[e][n+1]}</span></td>`;o+="</tr>"}$(n.find("tbody")).append(o)}$.each(o,(function(t,n){let r=$(this),o=r.find(".js-group-name"),i=r.find(".js-group-count");e["group_name_"+(t+1)]&&o.text(e["group_name_"+(t+1)]),e["group_count_"+(t+1)]&&i.text(e["group_count_"+(t+1)]),r.attr("href",`/all/${a}/steps/${t+2}/`)}))}(),d=JSON.stringify(d),l.val(d),t.length&&t.submit((function(){return c||(c=!0,o.prop("disabled","disabled"),$.ajax({url:i,data:{calc_name:a,json:l.val()},method:"POST",dataType:"html",headers:{"X-CSRFToken":s},success:function(e){"OK"==e?(m(),window.location.href=n):(c=!1,o.prop("disabled",""))},error:function(e){c=!1,alert("Ошибка! Попробуйте позже!"),o.prop("disabled","")}})),!1}))}():"short-result"==STEP?function(){let e=$(".js-form-send-promo"),t=e.find(".js-fieldset");if(e.length){let n=t.find("input");n.on("paste",(function(e){let t=e.originalEvent.clipboardData.getData("text/plain");for(let e=0;e<t.length;e++)n[e]&&$(n[e]).val(t[e]);return!1})),n.on("keyup",(function(e){if(!e.ctrlKey){let t=$(this),n=e.originalEvent.key,a=parseInt(t.attr("tabindex"));return e.which<=90&&e.which>=48?(t.val(n),a<9&&$(`input[tabindex=${a+1}]`).focus()):8==e.which&&a>1&&$(`input[tabindex=${a-1}]`).focus(),!1}}));let a=e.find('[name="csrfmiddlewaretoken"]').val(),r=e.attr("action"),o=!1;e.submit((function(e){if(!o){let e="";$.each(t.find("input"),(function(t,n){e+=$(n).val()})),8==e.length?(o=!0,t.prop("disabled","disabled"),$.ajax({url:r,data:{promo:e},method:"POST",dataType:"html",headers:{"X-CSRFToken":a},success:function(e){"OK"==e||(o=!1,t.prop("disabled",""))},error:function(e){"NOT EXIST"==e.responseText?alert("Промокод не существует!"):"USED"==e.responseText?alert("Промокод уже использован!"):alert("Ошибка! Попробуйте позже!"),t.prop("disabled",""),o=!1}})):alert("Введите корректный промокод!")}return!1}))}}():"full-result"==STEP||("profile"==STEP?function(){let e=$(".js-form-create-promo"),t=$(".js-delete-promo"),n=$(".js-show-add-email"),a=$(".js-add-email-form"),r=!1;e.length&&e.submit((function(e){if(!r){let e=$(this),t=e.find(".js-fieldset"),n=e.find(".js-promo-error"),a=e.find('[name="csrfmiddlewaretoken"]').val(),o=e.attr("action"),i=$(".js-promo-letters"),s="";$.each(i.find("input"),(function(e,t){s+=$(t).val()})),console.log(s),r=!0,t.prop("disabled","disabled"),n.removeClass("error"),$.ajax({url:o,data:{promo:s},method:"POST",dataType:"html",headers:{"X-CSRFToken":a},cache:!1,success:function(e){console.log(e),window.location.href=""},error:function(e){console.log(e),"EXIST"==e.responseText?alert("Ошибка! Промокод с таким названием уже существует!"):n.addClass("error"),r=!1,t.prop("disabled","")}})}return!1})),e.length&&(e.find("input").on("keyup",(function(e){let t=$(this),n=e.originalEvent.key,a=parseInt(t.attr("tabindex"));e.which<=90&&e.which>=48?(t.val(n),a<9&&$(`input[tabindex=${a+1}]`).focus()):8==e.which&&a>1&&$(`input[tabindex=${a-1}]`).focus()})),e.submit((function(e){return!1}))),t.length&&t.click((function(e){if(confirm("Вы действительно хотите удалить промокод?")){let e=$(this),t=$('[name="csrfmiddlewaretoken"]').val(),n=e.data("promo"),a="/all/accounts/delete_promo/";$.ajax({url:a,data:{promo:n},method:"POST",dataType:"html",headers:{"X-CSRFToken":t},cache:!1,success:function(t){e.closest("tr").remove()&&alert("Промокод удалён")},error:function(e){"NOT EXIST"==e.responseText?alert("Ошибка! Промокод с таким названием не существует!"):alert("Ошибка! Попробуйте позже!")}})}return!1})),n.length&&a.length&&n.click((function(e){"none"===a.css("display")&&a.slideToggle()}))}():"password"==STEP?function(){let e=$(".js-form-password-reset"),t=!1,n=e.find('[name="csrfmiddlewaretoken"]').val(),a=e.find(".js-fieldset"),r=e.find(".js-error");e.length&&e.submit((function(e){if(!t){let e=$(this),o=e.attr("action"),i=e.find('input[name="password1"]'),s=e.find('input[name="password2"]'),l={password1:i.val(),password2:s.val()};t=!0,a.prop("disabled","disabled"),r.removeClass("error"),e.find("input").removeClass("error"),r.html(""),$.ajax({url:o,data:l,method:"POST",dataType:"json",headers:{"X-CSRFToken":n},cache:!1,success:function(t){e.html("<p>Пароль успешно изменён!</p>")},error:function(n){for(let t in n.responseJSON.form.fields){let a=e.find(`input[name="${t}"]`),r=n.responseJSON.form.fields[t],o="";for(let e in r.errors)o+=r.errors[e]+"<br>";o.length&&(a.addClass("error"),a.next().html(o))}r.addClass("error"),t=!1,a.prop("disabled","")}})}return!1})),f()}():"login"==STEP?h():"signup"==STEP&&g())),v()}),document.addEventListener("DOMContentLoaded",c),window.YM_ID="57165547",window.ya=v,window.removeScale=function(e){$(e).parent().remove()},window.submitForm=function(){let e=$(".js-robokassa-form").find("form");u(e),p(),e.submit()},window.promoApply=function(e){let t=$(e),n=t.closest(".js-robokassa-form"),a=!0;$wrapper=t.closest(".js-payment-place");let r=$wrapper.find(".js-fieldset"),o=n.find('[name="csrfmiddlewaretoken"]').val();if(r.prop("disabled","disabled"),a){let e=$wrapper.find('[name="shppromo"]').val(),t=$wrapper.find('[name="shpcalc_name"]').val(),n="/all/accounts/apply_promo/";$.ajax({url:n,data:{promo:e,calc_name:t},method:"POST",dataType:"html",headers:{"X-CSRFToken":o},cache:!1,success:function(e){$wrapper.html(e),a=!1},error:function(e){"NOT EXIST"==e.responseText?alert("Ошибка! Промокод с таким названием не существует!"):"USED"==e.responseText?alert("Ошибка! Промокод уже использован вами!"):alert("Ошибка! Попробуйте позже!"),r.prop("disabled",""),a=!1}})}return!1},window.getPaymentMethodsAjax=l,window.changePaymentMethodsAjax=function(e){let t=$(e),n=t.parent().find("[name=shpcalc_name]").val(),a=t.parent().find("[name=shpprice_type]").val(),r=t.val(),o=!1,i=t.parent();if(!o){let e=t.parent().find('[name="csrfmiddlewaretoken"]').val(),s={calc_name:n,IncCurrLabel:r,price_type:a};i.prop("disabled","disabled"),o=!0,$.ajax({url:"/all/get_payment_methods_ajax/",data:s,method:"POST",dataType:"html",headers:{"X-CSRFToken":e},success:function(e){$.fancybox.destroy(),$.fancybox.open(e),i.prop("disabled",""),o=!1},error:function(e){alert("Ошибка! Попробуйте позже!"),i.prop("disabled",""),o=!1}})}},window.click_ya_payment_from_form=u,window.click_ga_payment=p,window.paymentFilter=function(e){let t=$(e),n=$(".js-filter-item"),a=$(".js-payment-list"),r=t.data("filter"),o=a.find(`[data-filter-target=${r}]`);n.removeClass("is-active"),t.addClass("is-active"),"all"!==r&&o.length?(a.children().hide(),o.show()):a.children().show()},window.selectPaymentMethod=function(e){let t=$(e),n=t.closest(".js-payment-methods"),a=n.data("calc_name"),r=n.data("price_type"),o=t.data("value"),i=n.find('[name="csrfmiddlewaretoken"]').val(),s=n.find(".js-hidden-form-place");$.ajax({url:"/all/ajax/get_payment_form/",data:{calc_name:a,price_type:r,IncCurrLabel:o},method:"POST",dataType:"html",headers:{"X-CSRFToken":i},success:function(e){s.html(e)},error:function(e){alert("Ошибка! Попробуйте позже!")}})},window.showPassword=f,window.preloader=m}]);